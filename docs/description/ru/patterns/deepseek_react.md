# Техническая документация: Паттерн `deepseek_react`

## 1. Обзор и назначение

`deepseek_react.py` — это **высокоструктурированная и методичная когнитивная архитектура** для `react_driver`. В отличие от `basic_react`, который фокусируется на эмуляции персоны, этот паттерн заставляет модель действовать как **экспертный AI-исследователь**.

**Основная цель**: Обеспечить максимальную предсказуемость, структурированность и верифицируемость результата для сложных аналитических и исследовательских задач.

Этот паттерн идеален для генерации отчетов, сравнений, технических объяснений и любых других задач, где важна логическая структура, точность и пошаговое выполнение.

## 2. Философия: Модель как методичный ассистент-исследователь

Там, где `basic_react` учит модель "чувствовать" и интерпретировать, `deepseek_react` учит ее "работать" как методичный ассистент-исследователь. Основная идея — декомпозировать сложную задачу на управляемые шаги и готовить ответ поэтапно.

Паттерн заставляет модель последовательно играть три роли:

1.  **Роль "Планировщика"**: В самом начале модель обязана составить четкий, пошаговый план действий.
2.  **Роль "Исполнителя"**: Модель итеративно и последовательно выполняет пункты плана, используя инструменты для сбора информации.
3.  **Роль "Редактора"**: Перед тем как дать финальный ответ, модель обязана синтезировать всю собранную информацию в структурированный **черновик (DRAFT)** прямо в своих мыслях.

Этот подход кардинально повышает качество и надежность ответов на сложные, фактологические запросы.

## 3. Четырехэтапная методология исследования

Это ядро паттерна. Модель обучается следовать строгому императивному процессу из четырех шагов:

1.  **Create a PLAN (Создай ПЛАН)**
    *   **Задача**: Декомпозировать запрос пользователя на логическую последовательность шагов.
    *   **Результат**: Явный, нумерованный план в самом начале работы.
2.  **EXECUTE the plan (ВЫПОЛНИ план)**
    *   **Задача**: Последовательно выполнить каждый пункт плана, используя инструменты для сбора фактов.
    *   **Результат**: Набор "наблюдений" (`Observation`) от инструментов.
3.  **Create a DRAFT (Создай ЧЕРНОВИК)**
    *   **Задача**: После сбора всей информации синтезировать ее в краткий, но структурированный черновик. Этот черновик создается в "мыслях" (`<THOUGHT>`) модели.
    *   **Результат**: "Скелет" для финального ответа, гарантирующий, что все ключевые пункты будут освещены в логическом порядке.
4.  **Format the draft into the FINAL ANSWER (Отформатируй черновик в ФИНАЛЬНЫЙ ОТВЕТ)**
    *   **Задача**: Превратить структурированный, но сжатый черновик в развернутый, хорошо отформатированный и легко читаемый финальный ответ.
    *   **Результат**: Качественный итоговый текст.

## 4. Реализация в промпте

Этот процесс, как и в других паттернах, реализуется через системные инструкции и **обучающий пример (Few-Shot Example)**.

*   **Системные инструкции**: Четко задают роль "экспертного AI-исследователя" и императивно определяют четырехэтапную методологию.
*   **Обучающий пример**: Демонстрирует применение методологии на практике.

**Ключевые моменты в обучающем примере:**
1.  **Явный План**: Первая же "мысль" (`<THOUGHT>`) модели содержит явный, нумерованный `PLAN`. Это приучает ее к декомпозиции задачи *перед* началом работы.
2.  **Итеративное Выполнение**: Модель учится в своих мыслях ссылаться на конкретные шаги плана (`Executing Step 1...`, `Executing Step 2...`), что делает ее работу методичной.
3.  **Структурированный Черновик**: Это кульминация обучения. В финальной "мысли" модель явно объявляет о переходе к шагу 3, создает структурированный `DRAFT`, а затем объявляет о переходе к шагу 4. Это закрепляет связь между предварительной подготовкой и качественным результатом.

## 5. Практическое применение и ценность

*   **Структурированные и верифицируемые ответы**: Наличие явного плана и черновика в логах (`scratchpad`) позволяет легко отследить и проверить логику модели, что критически важно для отладки.
*   **Производительность на сложных запросах**: Декомпозиция задачи помогает модели не "потеряться" при обработке многосоставных запросов.
*   **Высокая консистентность**: Жесткая структура приводит к более предсказуемому и единообразному формату ответов.

**Когда использовать этот паттерн**: Выбирайте `deepseek_react` для задач, требующих аналитического, структурированного и фактологического подхода. Он менее подходит для креативных или разговорных задач, где лучше себя покажет `basic_react`.